import { joinVoiceChannel } from "@discordjs/voice";
import { Player } from "discord-music-player";
import {
  Client,
  EmbedBuilder,
  AuditLogEvent
} from "discord.js";
class myClient extends Client {
  constructor(arg) {
    super(arg);
    this.player = new Player(this, {
      leaveOnEnd: false,
      leaveOnStop: false,
      leaveOnEmpty: true,
      timeout: 0,
      volume: 50,
      quality: "high"
    });
    this.CONFIG_CHANNEL_ID = null;
    this.LOG_CHANNEL_ID = "871760169770582066";
    this.ADMIN_ID = "247100615489093632";
  }
  join(message) {
    return joinVoiceChannel({
      guildId: message.guildId,
      channelId: message.member.voice.channelId,
      adapterCreator: message.guild.voiceAdapterCreator
    });
  }
  logChannelMsg(message) {
    return message.guild.channels.cache.find(
      (chan) => chan.id === "871760169770582066"
    );
  }
  logChannelVoice(arg) {
    return arg.guild.channels.cache.find(
      (chan) => chan.id === "872055513871958046"
    );
  }
  logChannelUserState(member) {
    return member.guild.channels.cache.get("872907085002702859");
  }
  checkPerm(msg, permList) {
    return msg.member.permissions.has(permList) || msg.member.user.id === this.ADMIN_ID;
  }
  get eventTime() {
    const checkNum = (arg) => {
      if (arg < 10) {
        return "0" + arg;
      } else {
        return arg;
      }
    };
    const createdAt = new Date();
    return {
      year: checkNum(createdAt.getFullYear()),
      month: checkNum(createdAt.getMonth() + 1),
      day: checkNum(createdAt.getDate()),
      hours: checkNum(createdAt.getHours()),
      minutes: checkNum(createdAt.getMinutes()),
      seconds: checkNum(createdAt.getSeconds())
    };
  }
  createEmbed(color, title, author, ...fields) {
    const time = this.eventTime;
    const embed = new EmbedBuilder().setColor(color).setTitle(title).setAuthor({ name: author }).addFields(...fields).setTimestamp().setFooter({ text: `${time.hours} H ${time.minutes}  -  ${time.day}/${time.month}/${time.year}` });
    return embed;
  }
  async logMsg(message, prefix) {
    if ([
      this.logChannelMsg(message).id,
      this.logChannelVoice(message).id,
      this.logChannelUserState(message.member).id
    ].includes(message.channel.id))
      return;
    if (message.author.bot)
      return;
    const command = message.content.startsWith(prefix);
    const color = command ? "Yellow" : "Green";
    const title = command ? "Try Command" : "Send Message";
    const embed = this.createEmbed(
      color,
      title,
      message.id,
      { name: "User", value: `<@${message.member.user.id}>`, inline: true },
      { name: "Message", value: message.content, inline: true },
      { name: "Channel", value: message.channel.name, inline: true }
    );
    await this.logChannelMsg(message).send({ embeds: [embed.data] });
  }
  async logDeleteMsg(message) {
    try {
      const fetchedLog = await message.guild.fetchAuditLogs({
        type: AuditLogEvent.MessageDelete,
        limit: 1
      });
      const executer = fetchedLog.entries.first().executor;
      const author = message.member.user;
      const embed = this.createEmbed(
        "Orange",
        "Message Deleted",
        message.id,
        { name: "Author", value: `<@${author.id}>`, inline: true },
        { name: "Message", value: message.content, inline: true },
        { name: "Channel", value: message.channel.name, inline: true },
        { name: `deleted by`, value: `<@${executer.id}>`, inline: false }
      );
      this.logChannelMsg(message).send({ embeds: [embed.data] });
    } catch (e) {
      console.error(e);
    }
  }
  async logUpdateMsg(oldMessage, newMessage) {
    const embed = this.createEmbed(
      "Blue",
      "Message Updated",
      newMessage.id,
      { name: "Author", value: `<@${newMessage.author.id}>`, inline: true },
      { name: "Old Message", value: oldMessage.content, inline: true },
      { name: `New Message`, value: newMessage.content, inline: true },
      { name: "Channel", value: newMessage.channel.name, inline: false }
    );
    await this.logChannelMsg(newMessage).send({ embeds: [embed] });
  }
  async logUserState(member) {
    const message = await member.guild.members.fetch(member) ? "User join guild" : "User leave guild";
    const embed = this.createEmbed(
      "Green",
      message,
      member.id,
      { name: "User", value: `<@${member.id}>`, inline: true },
      { name: "As", value: member.user.username, inline: true }
    );
    await this.logChannelUserState(member).send({ embeds: [embed.data] });
  }
  async logVoiceUpdate(oldstate, newState) {
    let embed;
    if (oldstate.channelId) {
      if (newState.channelId) {
        embed = this.createEmbed(
          "Blue",
          "User Switch voiceChat",
          newState.member.id,
          { name: "User", value: `<@${newState.member.id}>`, inline: false },
          { name: "Old channel", value: oldstate.channel.name, inline: true },
          { name: "New Channel", value: newState.channel.name, inline: true }
        );
      } else {
        embed = this.createEmbed(
          "Green",
          "User leave voiceChat",
          oldstate.member.id,
          { name: "User", value: `<@${oldstate.member.id}>`, inline: true },
          { name: "Channel", value: oldstate.channel.name, inline: true }
        );
      }
    } else {
      embed = this.createEmbed(
        "Green",
        "User join a voiceChat",
        newState.member.id,
        { name: "User", value: `<@${newState.member.id}>`, inline: true },
        { name: "Channel", value: newState.channel.name, inline: true }
      );
    }
    await this.logChannelVoice(oldstate).send({ embeds: [embed.data] });
  }
  loadResponse(message) {
    const channelConfig = message.guild.channels.cache.find(
      (chan) => chan.id === this.CONFIG_CHANNEL_ID
    );
  }
}
var customClient_default = myClient;
export {
  customClient_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2N1c3RvbUNsaWVudC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgam9pblZvaWNlQ2hhbm5lbCB9IGZyb20gXCJAZGlzY29yZGpzL3ZvaWNlXCI7XHJcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCJkaXNjb3JkLW11c2ljLXBsYXllclwiO1xyXG5pbXBvcnQge1xyXG4gICAgQ2xpZW50LFxyXG4gICAgTWVzc2FnZSxcclxuICAgIFBlcm1pc3Npb25zU3RyaW5nLFxyXG4gICAgVm9pY2VTdGF0ZSxcclxuICAgIFRleHRDaGFubmVsLFxyXG4gICAgRW1iZWRCdWlsZGVyLFxyXG4gICAgQ29sb3JSZXNvbHZhYmxlLFxyXG4gICAgRW1iZWRGaWVsZCxcclxuICAgIEd1aWxkTWVtYmVyLFxyXG4gICAgQ2xpZW50T3B0aW9ucyxcclxuICAgIEF1ZGl0TG9nRXZlbnRcclxuICB9IGZyb20gXCJkaXNjb3JkLmpzXCI7XHJcblxyXG5jbGFzcyBteUNsaWVudCBleHRlbmRzIENsaWVudCB7XHJcbiAgY29uc3RydWN0b3IgKGFyZzogQ2xpZW50T3B0aW9ucykge1xyXG4gICAgc3VwZXIoYXJnKVxyXG4gIH1cclxuXHJcbiAgcGxheWVyID0gbmV3IFBsYXllcih0aGlzLCB7XHJcbiAgICBsZWF2ZU9uRW5kOiBmYWxzZSxcclxuICAgIGxlYXZlT25TdG9wOiBmYWxzZSxcclxuICAgIGxlYXZlT25FbXB0eTogdHJ1ZSxcclxuICAgIHRpbWVvdXQ6IDAsXHJcbiAgICB2b2x1bWU6IDUwLFxyXG4gICAgcXVhbGl0eTogXCJoaWdoXCIsXHJcbiAgfSk7XHJcblxyXG4gIENPTkZJR19DSEFOTkVMX0lEID0gbnVsbFxyXG4gIExPR19DSEFOTkVMX0lEID0gXCI4NzE3NjAxNjk3NzA1ODIwNjZcIlxyXG4gIEFETUlOX0lEID0gXCIyNDcxMDA2MTU0ODkwOTM2MzJcIjtcclxuXHJcbiAgam9pbiAobWVzc2FnZTogTWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIGpvaW5Wb2ljZUNoYW5uZWwoe1xyXG4gICAgICBndWlsZElkOm1lc3NhZ2UuZ3VpbGRJZCEsXHJcbiAgICAgIGNoYW5uZWxJZDptZXNzYWdlLm1lbWJlciEudm9pY2UuY2hhbm5lbElkISxcclxuICAgICAgYWRhcHRlckNyZWF0b3I6bWVzc2FnZS5ndWlsZCEudm9pY2VBZGFwdGVyQ3JlYXRvclxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGxvZ0NoYW5uZWxNc2cobWVzc2FnZTogTWVzc2FnZSk6IFRleHRDaGFubmVsIHtcclxuICAgIHJldHVybiBtZXNzYWdlLmd1aWxkIS5jaGFubmVscy5jYWNoZS5maW5kKFxyXG4gICAgICAoY2hhbikgPT4gY2hhbi5pZCA9PT0gXCI4NzE3NjAxNjk3NzA1ODIwNjZcIlxyXG4gICAgKSBhcyBUZXh0Q2hhbm5lbDtcclxuICB9XHJcblxyXG4gIGxvZ0NoYW5uZWxWb2ljZShhcmc6IFZvaWNlU3RhdGUgfCBNZXNzYWdlKTogVGV4dENoYW5uZWwge1xyXG4gICAgcmV0dXJuIGFyZy5ndWlsZCEuY2hhbm5lbHMuY2FjaGUuZmluZChcclxuICAgICAgKGNoYW4pID0+IGNoYW4uaWQgPT09IFwiODcyMDU1NTEzODcxOTU4MDQ2XCJcclxuICAgICkgYXMgVGV4dENoYW5uZWw7XHJcbiAgfVxyXG5cclxuICBsb2dDaGFubmVsVXNlclN0YXRlKG1lbWJlcjogR3VpbGRNZW1iZXIpOiBUZXh0Q2hhbm5lbCB7XHJcbiAgICByZXR1cm4gbWVtYmVyLmd1aWxkLmNoYW5uZWxzLmNhY2hlLmdldChcIjg3MjkwNzA4NTAwMjcwMjg1OVwiKSBhcyBUZXh0Q2hhbm5lbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrIGlmIHRoZSB1c2VyIHdobyB3cm90ZSB0aGUgY29tbWFuZCBoYXMgdGhlIHBlcm0gZm9yIHBlcmZvbWluZyBpdFxyXG4gICAqL1xyXG4gIGNoZWNrUGVybShtc2c6IE1lc3NhZ2UsIHBlcm1MaXN0OiBQZXJtaXNzaW9uc1N0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgbXNnLm1lbWJlciEucGVybWlzc2lvbnMuaGFzKHBlcm1MaXN0KSB8fCBtc2cubWVtYmVyIS51c2VyLmlkID09PSB0aGlzLkFETUlOX0lEXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogIGdldCBkYXRlIGluZm9ybWF0aW9uXHJcbiAgICovXHJcbiAgZ2V0IGV2ZW50VGltZSgpIHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmdcclxuICAgICAqIEByZXR1cm5zICB7bnVtYmVyIHwgc3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBjb25zdCBjaGVja051bSA9IChhcmc6IG51bWJlcik6IG51bWJlciB8IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmIChhcmcgPCAxMCkge1xyXG4gICAgICAgIHJldHVybiBcIjBcIiArIGFyZztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gYXJnO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgY3JlYXRlZEF0ID0gbmV3IERhdGUoKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHllYXI6IGNoZWNrTnVtKGNyZWF0ZWRBdC5nZXRGdWxsWWVhcigpKSxcclxuICAgICAgbW9udGg6IGNoZWNrTnVtKGNyZWF0ZWRBdC5nZXRNb250aCgpICsgMSksXHJcbiAgICAgIGRheTogY2hlY2tOdW0oY3JlYXRlZEF0LmdldERhdGUoKSksXHJcbiAgICAgIGhvdXJzOiBjaGVja051bShjcmVhdGVkQXQuZ2V0SG91cnMoKSksXHJcbiAgICAgIG1pbnV0ZXM6IGNoZWNrTnVtKGNyZWF0ZWRBdC5nZXRNaW51dGVzKCkpLFxyXG4gICAgICBzZWNvbmRzOiBjaGVja051bShjcmVhdGVkQXQuZ2V0U2Vjb25kcygpKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiAgY3JlYXRlIGVtYmVkIG1lc3NhZ2VcclxuICAgKi9cclxuICBjcmVhdGVFbWJlZChjb2xvcjogQ29sb3JSZXNvbHZhYmxlLCB0aXRsZTogc3RyaW5nLCBhdXRob3I6IHN0cmluZywgLi4uZmllbGRzOiBFbWJlZEZpZWxkW10pOiBFbWJlZEJ1aWxkZXIge1xyXG4gICAgY29uc3QgdGltZSA9IHRoaXMuZXZlbnRUaW1lO1xyXG4gICAgY29uc3QgZW1iZWQgPSBuZXcgRW1iZWRCdWlsZGVyKClcclxuICAgICAgLnNldENvbG9yKGNvbG9yKVxyXG4gICAgICAuc2V0VGl0bGUodGl0bGUpXHJcbiAgICAgIC5zZXRBdXRob3IoeyBuYW1lOiBhdXRob3IgfSlcclxuICAgICAgLmFkZEZpZWxkcyguLi5maWVsZHMpXHJcbiAgICAgIC5zZXRUaW1lc3RhbXAoKVxyXG4gICAgICAuc2V0Rm9vdGVyKHsgdGV4dDogYCR7dGltZS5ob3Vyc30gSCAke3RpbWUubWludXRlc30gIC0gICR7dGltZS5kYXl9LyR7dGltZS5tb250aH0vJHt0aW1lLnllYXJ9YH0pO1xyXG4gICAgcmV0dXJuIGVtYmVkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGlzcGxheSBhbGwgXCJzZW5kIG1lc3NhZ2VcIiBldmVudCBvbiBzZWxlY3RlZCBjaGFubmVsXHJcbiAgICovXHJcbiAgYXN5bmMgbG9nTXNnKG1lc3NhZ2U6IE1lc3NhZ2UsIHByZWZpeDogc3RyaW5nKSB7XHJcbiAgICBpZiAoW1xyXG4gICAgICB0aGlzLmxvZ0NoYW5uZWxNc2cobWVzc2FnZSkuaWQsIFxyXG4gICAgICB0aGlzLmxvZ0NoYW5uZWxWb2ljZShtZXNzYWdlKS5pZCwgXHJcbiAgICAgIHRoaXMubG9nQ2hhbm5lbFVzZXJTdGF0ZShtZXNzYWdlLm1lbWJlciEpLmlkXHJcbiAgICBdLmluY2x1ZGVzKG1lc3NhZ2UuY2hhbm5lbC5pZCkpIHJldHVybjtcclxuICBcclxuICAgIGlmIChtZXNzYWdlLmF1dGhvci5ib3QpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBjb21tYW5kID0gbWVzc2FnZS5jb250ZW50LnN0YXJ0c1dpdGgocHJlZml4KTtcclxuICAgIGNvbnN0IGNvbG9yID0gY29tbWFuZCA/IFwiWWVsbG93XCIgOiBcIkdyZWVuXCI7XHJcbiAgICBjb25zdCB0aXRsZSA9IGNvbW1hbmQgPyBcIlRyeSBDb21tYW5kXCIgOiBcIlNlbmQgTWVzc2FnZVwiO1xyXG4gICAgY29uc3QgZW1iZWQgPSB0aGlzLmNyZWF0ZUVtYmVkKFxyXG4gICAgICBjb2xvcixcclxuICAgICAgdGl0bGUsXHJcbiAgICAgIG1lc3NhZ2UuaWQsXHJcbiAgICAgIHsgbmFtZTogXCJVc2VyXCIsIHZhbHVlOiBgPEAke21lc3NhZ2UubWVtYmVyIS51c2VyLmlkfT5gLCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgeyBuYW1lOiBcIk1lc3NhZ2VcIiwgdmFsdWU6IG1lc3NhZ2UuY29udGVudCwgaW5saW5lOiB0cnVlIH0sXHJcbiAgICAgIHsgbmFtZTogXCJDaGFubmVsXCIsIHZhbHVlOiAobWVzc2FnZS5jaGFubmVsIGFzIFRleHRDaGFubmVsKS5uYW1lLCBpbmxpbmU6IHRydWUgfVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLmxvZ0NoYW5uZWxNc2cobWVzc2FnZSkuc2VuZCh7IGVtYmVkczogW2VtYmVkLmRhdGFdfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2dEZWxldGVNc2cobWVzc2FnZTogTWVzc2FnZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZmV0Y2hlZExvZyA9IGF3YWl0IG1lc3NhZ2UuZ3VpbGQhLmZldGNoQXVkaXRMb2dzKHtcclxuICAgICAgICB0eXBlOiBBdWRpdExvZ0V2ZW50Lk1lc3NhZ2VEZWxldGUsXHJcbiAgICAgICAgbGltaXQ6IDEsXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCBleGVjdXRlciA9IGZldGNoZWRMb2cuZW50cmllcy5maXJzdCgpIS5leGVjdXRvciE7XHJcbiAgICAgIGNvbnN0IGF1dGhvciA9IG1lc3NhZ2UubWVtYmVyIS51c2VyO1xyXG4gICAgICBjb25zdCBlbWJlZCA9IHRoaXMuY3JlYXRlRW1iZWQoXHJcbiAgICAgICAgXCJPcmFuZ2VcIixcclxuICAgICAgICBcIk1lc3NhZ2UgRGVsZXRlZFwiLFxyXG4gICAgICAgIG1lc3NhZ2UuaWQsXHJcbiAgICAgICAgeyBuYW1lOiBcIkF1dGhvclwiLCB2YWx1ZTogYDxAJHthdXRob3IuaWR9PmAsIGlubGluZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgbmFtZTogXCJNZXNzYWdlXCIsIHZhbHVlOiBtZXNzYWdlLmNvbnRlbnQsIGlubGluZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgbmFtZTogXCJDaGFubmVsXCIsIHZhbHVlOiAobWVzc2FnZS5jaGFubmVsIGFzIFRleHRDaGFubmVsKS5uYW1lLCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgICB7IG5hbWU6IGBkZWxldGVkIGJ5YCwgdmFsdWU6IGA8QCR7ZXhlY3V0ZXIuaWR9PmAsIGlubGluZTogZmFsc2UgfVxyXG4gICAgICApO1xyXG4gICAgICB0aGlzLmxvZ0NoYW5uZWxNc2cobWVzc2FnZSkuc2VuZCh7IGVtYmVkczogW2VtYmVkLmRhdGFdfSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2dVcGRhdGVNc2cob2xkTWVzc2FnZTogTWVzc2FnZSwgbmV3TWVzc2FnZTogTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZW1iZWQgPSB0aGlzLmNyZWF0ZUVtYmVkKFxyXG4gICAgICBcIkJsdWVcIixcclxuICAgICAgXCJNZXNzYWdlIFVwZGF0ZWRcIixcclxuICAgICAgbmV3TWVzc2FnZS5pZCxcclxuICAgICAgeyBuYW1lOiBcIkF1dGhvclwiLCB2YWx1ZTogYDxAJHtuZXdNZXNzYWdlLmF1dGhvci5pZH0+YCwgaW5saW5lOiB0cnVlIH0sXHJcbiAgICAgIHsgbmFtZTogXCJPbGQgTWVzc2FnZVwiLCB2YWx1ZTogb2xkTWVzc2FnZS5jb250ZW50LCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgeyBuYW1lOiBgTmV3IE1lc3NhZ2VgLCB2YWx1ZTogbmV3TWVzc2FnZS5jb250ZW50LCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgeyBuYW1lOiBcIkNoYW5uZWxcIiwgdmFsdWU6IChuZXdNZXNzYWdlLmNoYW5uZWwgYXMgVGV4dENoYW5uZWwpLm5hbWUsIGlubGluZTogZmFsc2UgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IHRoaXMubG9nQ2hhbm5lbE1zZyhuZXdNZXNzYWdlKS5zZW5kKHsgZW1iZWRzOiBbZW1iZWRdfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2dVc2VyU3RhdGUobWVtYmVyOiBHdWlsZE1lbWJlcikge1xyXG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IG1lbWJlci5ndWlsZC5tZW1iZXJzLmZldGNoKG1lbWJlcilcclxuICAgICAgPyBcIlVzZXIgam9pbiBndWlsZFwiXHJcbiAgICAgIDogXCJVc2VyIGxlYXZlIGd1aWxkXCI7XHJcbiAgICBjb25zdCBlbWJlZCA9IHRoaXMuY3JlYXRlRW1iZWQoXHJcbiAgICAgIFwiR3JlZW5cIixcclxuICAgICAgbWVzc2FnZSxcclxuICAgICAgbWVtYmVyLmlkLFxyXG4gICAgICB7IG5hbWU6IFwiVXNlclwiLCB2YWx1ZTogYDxAJHttZW1iZXIuaWR9PmAsIGlubGluZTogdHJ1ZSB9LFxyXG4gICAgICB7IG5hbWU6IFwiQXNcIiwgdmFsdWU6IG1lbWJlci51c2VyLnVzZXJuYW1lLCBpbmxpbmU6IHRydWUgfVxyXG4gICAgKTtcclxuICAgIGF3YWl0IHRoaXMubG9nQ2hhbm5lbFVzZXJTdGF0ZShtZW1iZXIpLnNlbmQoeyBlbWJlZHM6IFtlbWJlZC5kYXRhXX0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9nVm9pY2VVcGRhdGUob2xkc3RhdGU6IFZvaWNlU3RhdGUsIG5ld1N0YXRlOiBWb2ljZVN0YXRlKSB7XHJcbiAgICBsZXQgZW1iZWQ7XHJcbiAgICBpZiAob2xkc3RhdGUuY2hhbm5lbElkKSB7XHJcbiAgICAgIGlmIChuZXdTdGF0ZS5jaGFubmVsSWQpIHtcclxuICAgICAgICBlbWJlZCA9IHRoaXMuY3JlYXRlRW1iZWQoXHJcbiAgICAgICAgICBcIkJsdWVcIixcclxuICAgICAgICAgIFwiVXNlciBTd2l0Y2ggdm9pY2VDaGF0XCIsXHJcbiAgICAgICAgICBuZXdTdGF0ZS5tZW1iZXIhLmlkLFxyXG4gICAgICAgICAgeyBuYW1lOiBcIlVzZXJcIiwgdmFsdWU6IGA8QCR7bmV3U3RhdGUubWVtYmVyIS5pZH0+YCwgaW5saW5lOiBmYWxzZSB9LFxyXG4gICAgICAgICAgeyBuYW1lOiBcIk9sZCBjaGFubmVsXCIsIHZhbHVlOiBvbGRzdGF0ZS5jaGFubmVsIS5uYW1lLCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgICAgIHsgbmFtZTogXCJOZXcgQ2hhbm5lbFwiLCB2YWx1ZTogbmV3U3RhdGUuY2hhbm5lbCEubmFtZSwgaW5saW5lOiB0cnVlIH1cclxuICAgICAgICApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVtYmVkID0gdGhpcy5jcmVhdGVFbWJlZChcclxuICAgICAgICAgIFwiR3JlZW5cIixcclxuICAgICAgICAgIFwiVXNlciBsZWF2ZSB2b2ljZUNoYXRcIixcclxuICAgICAgICAgIG9sZHN0YXRlLm1lbWJlciEuaWQsXHJcbiAgICAgICAgICB7IG5hbWU6IFwiVXNlclwiLCB2YWx1ZTogYDxAJHtvbGRzdGF0ZS5tZW1iZXIhLmlkfT5gLCBpbmxpbmU6IHRydWUgfSxcclxuICAgICAgICAgIHsgbmFtZTogXCJDaGFubmVsXCIsIHZhbHVlOiBvbGRzdGF0ZS5jaGFubmVsIS5uYW1lLCBpbmxpbmU6IHRydWUgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGVtYmVkID0gdGhpcy5jcmVhdGVFbWJlZChcclxuICAgICAgICBcIkdyZWVuXCIsXHJcbiAgICAgICAgXCJVc2VyIGpvaW4gYSB2b2ljZUNoYXRcIixcclxuICAgICAgICBuZXdTdGF0ZS5tZW1iZXIhLmlkLFxyXG4gICAgICAgIHsgbmFtZTogXCJVc2VyXCIsIHZhbHVlOiBgPEAke25ld1N0YXRlLm1lbWJlciEuaWR9PmAsIGlubGluZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgbmFtZTogXCJDaGFubmVsXCIsIHZhbHVlOiBuZXdTdGF0ZS5jaGFubmVsIS5uYW1lLCBpbmxpbmU6IHRydWUgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGF3YWl0IHRoaXMubG9nQ2hhbm5lbFZvaWNlKG9sZHN0YXRlKS5zZW5kKHsgZW1iZWRzOiBbZW1iZWQuZGF0YV19KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge01lc3NhZ2V9IG1lc3NhZ2VcclxuICAgKi9cclxuICBsb2FkUmVzcG9uc2UobWVzc2FnZTogTWVzc2FnZSkge1xyXG4gICAgY29uc3QgY2hhbm5lbENvbmZpZyA9IG1lc3NhZ2UuZ3VpbGQhLmNoYW5uZWxzLmNhY2hlLmZpbmQoXHJcbiAgICAgIChjaGFuKSA9PiBjaGFuLmlkID09PSB0aGlzLkNPTkZJR19DSEFOTkVMX0lEXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG15Q2xpZW50XHJcbiJdLAogICJtYXBwaW5ncyI6ICJBQUFBLFNBQVMsd0JBQXdCO0FBQ2pDLFNBQVMsY0FBYztBQUN2QjtBQUFBLEVBQ0k7QUFBQSxFQUtBO0FBQUEsRUFLQTtBQUFBLE9BQ0s7QUFFVCxNQUFNLGlCQUFpQixPQUFPO0FBQUEsRUFDNUIsWUFBYSxLQUFvQjtBQUMvQixVQUFNLEdBQUc7QUFHWCxrQkFBUyxJQUFJLE9BQU8sTUFBTTtBQUFBLE1BQ3hCLFlBQVk7QUFBQSxNQUNaLGFBQWE7QUFBQSxNQUNiLGNBQWM7QUFBQSxNQUNkLFNBQVM7QUFBQSxNQUNULFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxJQUNYLENBQUM7QUFFRCw2QkFBb0I7QUFDcEIsMEJBQWlCO0FBQ2pCLG9CQUFXO0FBQUEs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
